{"remainingRequest":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/babel-loader/lib/index.js!/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/src/components/user/HeadPortrait.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/src/components/user/HeadPortrait.vue","mtime":1653461187972},{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/babel.config.js","mtime":1650971271303},{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/cache-loader/dist/cjs.js","mtime":1650971228569},{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/babel-loader/lib/index.js","mtime":1650971231053},{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/cache-loader/dist/cjs.js","mtime":1650971228569},{"path":"/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/node_modules/vue-loader-v16/dist/index.js","mtime":1650971226130}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0IGVtaXR0ZXIgZnJvbSAnQC91dGlscy9ldmVudCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSGVhZFBvcnRyYWl0JywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICB0b2tlbjogJycsCiAgICAgIHByb2dyZXNzRmxhZzogZmFsc2UsCiAgICAgIGxvYWRQcm9ncmVzczogMCwKICAgICAgdGltZXI6IG51bGwsCiAgICAgIHRpbWVyMjogbnVsbCwKICAgICAgdHJhbnNtaXNzaW9uOiAnc3VjY2VzcycKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgY29uZmlnOiBmdW5jdGlvbiBjb25maWcoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgQXV0aG9yaXphdGlvbjogIkpXVCAiLmNvbmNhdCh0aGlzLnRva2VuKQogICAgICB9OwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5aS05YOP5LiK5Lyg5oiQ5YqfCiAgICBoYW5kbGVBdmF0YXJTdWNjZXNzOiBmdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWNjZXNzKHJlc3BvbnNlLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKHJlc3BvbnNlLmNvZGUgPT09IDIwMCkgewogICAgICAgIGVtaXR0ZXIuZW1pdCgnaW1hZ2UnLCB7CiAgICAgICAgICBhaW06IHJlc3BvbnNlLmRhdGEKICAgICAgICB9KTsKICAgICAgICB0aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKF90aGlzLmxvYWRQcm9ncmVzcyA8IDEwMCkgewogICAgICAgICAgICBfdGhpcy5sb2FkUHJvZ3Jlc3MrKzsKCiAgICAgICAgICAgIGlmIChfdGhpcy5sb2FkUHJvZ3Jlc3MgPT09IDEwMCkgewogICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMudGltZXIpOwogICAgICAgICAgICAgIF90aGlzLnRpbWVyID0gbnVsbDsKICAgICAgICAgICAgICBjbGVhckludGVydmFsKF90aGlzLnRpbWVyMik7CiAgICAgICAgICAgICAgX3RoaXMudGltZXIyID0gbnVsbDsKCiAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+S4iuS8oOaIkOWKnycsCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIDEwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRyYW5zbWlzc2lvbiA9ICdleGNlcHRpb24nOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOWksei0peivt+eojeWQjumHjeivlScpOwogICAgICB9CiAgICB9LAogICAgdXBMb2FkOiBmdW5jdGlvbiB1cExvYWQoZXZlbnQsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5wcm9ncmVzc0ZsYWcgPSB0cnVlOwogICAgICB0aGlzLnRpbWVyMiA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczIubG9hZFByb2dyZXNzKys7CgogICAgICAgIGlmIChfdGhpczIubG9hZFByb2dyZXNzID4gNzIpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwoX3RoaXMyLnRpbWVyMik7IC8vIOi/memHjOW/hemhu+S9v+eUqHRoaXMudGltZXIgPSBudWxs77yM5ZCm5YiZ5riF6Zmk5a6a5pe25Zmo5peg5pWICgogICAgICAgICAgX3RoaXMyLnRpbWVyMiA9IG51bGw7CiAgICAgICAgfQogICAgICB9LCAxMDApOwogICAgfSwKICAgIC8vIOeCueWHu+S4iuS8oOWktOWDjwogICAgc3VibWl0VXBsb2FkOiBmdW5jdGlvbiBzdWJtaXRVcGxvYWQoKSB7CiAgICAgIHRoaXMudG9rZW4gPSB0aGlzLiRzdG9yZS5zdGF0ZS50b2tlbjsKICAgICAgdGhpcy5sb2FkUHJvZ3Jlc3MgPSAwOwogICAgICB0aGlzLiRyZWZzLnVwbG9hZC5zdWJtaXQoKTsKICAgIH0sCiAgICAvLyDlhbPpl63lpLTlg4/pgInmi6kKICAgIGNsb3NlX2hlYWRfcG9ydHJhaXQ6IGZ1bmN0aW9uIGNsb3NlX2hlYWRfcG9ydHJhaXQoKSB7CiAgICAgIGVtaXR0ZXIuZW1pdCgnc2hvdycsIHsKICAgICAgICBhaW06IGZhbHNlCiAgICAgIH0pOwogICAgICB0aGlzLnByb2dyZXNzRmxhZyA9IGZhbHNlOwogICAgICB0aGlzLmxvYWRQcm9ncmVzcyA9IDA7CiAgICAgIHRoaXMuZmlsZUxpc3QgPSBbXTsKICAgIH0sCiAgICAvLyDkuIrkvKDmlofku7bnmoTpmZDliLYKICAgIGJlZm9yZUF2YXRhclVwbG9hZDogZnVuY3Rpb24gYmVmb3JlQXZhdGFyVXBsb2FkKGZpbGUpIHsKICAgICAgY29uc29sZS5sb2coZmlsZS50eXBlKTsKICAgICAgdmFyIGlzSlBHID0gZmlsZS50eXBlID09PSAnaW1hZ2UvcG5nJyB8fCAnaW1hZ2UvanBlZyc7CiAgICAgIHZhciBpc0x0NU0gPSBmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA8IDU7CgogICAgICBpZiAoIWlzSlBHKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5LiK5Lyg5aS05YOP5Zu+54mH5Y+q6IO95pivIEpQRy9QTkcg5qC85byPIScpOwogICAgICB9CgogICAgICBpZiAoIWlzTHQ1TSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+S4iuS8oOWktOWDj+WbvueJh+Wkp+Wwj+S4jeiDvei2hei/hyA1TUIhJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpc0pQRyAmJiBpc0x0NU07CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgZmlsZUxpc3Q6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuZXdWYWwsIG9sZFZhbCkgewogICAgICAgIGlmIChuZXdWYWwubGVuZ3RoID4gMSkgewogICAgICAgICAgbmV3VmFsLnNwbGljZSgwLCAxKTsKICAgICAgICAgIHRoaXMucHJvZ3Jlc3NGbGFnID0gZmFsc2U7CiAgICAgICAgICB0aGlzLmxvYWRQcm9ncmVzcyA9IDA7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["emitter","name","data","fileList","token","progressFlag","loadProgress","timer","timer2","transmission","computed","config","Authorization","methods","handleAvatarSuccess","response","file","code","emit","aim","setInterval","clearInterval","$message","message","type","error","upLoad","event","submitUpload","$store","state","$refs","upload","submit","close_head_portrait","beforeAvatarUpload","console","log","isJPG","isLt5M","size","watch","handler","newVal","oldVal","length","splice","deep"],"sourceRoot":"","sources":["/Users/yujunxiong/Desktop/shopFrontEnd/shopcart/src/components/user/HeadPortrait.vue"],"sourcesContent":["<template>\n  <div id=\"head-portrait\">\n    <div class=\"title\">\n      <div>自定义头像</div>\n      <span class=\"iconfont\" @click=\"close_head_portrait\">&#xeca0;</span>\n    </div>\n    <div class=\"tips\">\n      <el-upload\n        ref=\"upload\"\n        action=\"http://localhost:8000/user/upimage/\"\n        :headers=\"config\"\n        :on-progress=\"upLoad\"\n        :before-upload=\"beforeAvatarUpload\"\n        :file-list=\"fileList\"\n        list-type=\"picture-card\"\n        :on-success=\"handleAvatarSuccess\"\n        :auto-upload=\"false\">\n        <div class=\"upImage\">上传头像</div>\n      </el-upload>\n      <span>支持大小不超过 5M 的jpg，png的图片</span>\n    </div>\n    <div id=\"content\">\n      <div class=\"show\">\n        <img :src=\"fileList[0]?.url\" alt=\"\" />\n      </div>\n      <div class=\"preview\">\n        <span>预览</span>\n        <div :style=\"{backgroundImage: 'url('+fileList[0]?.url+')'}\"></div>\n        <el-progress type=\"circle\" v-show=\"progressFlag\" :percentage=\"loadProgress\" :status=\"transmission\" class=\"progress\"></el-progress>\n      </div>\n    </div>\n    <div class=\"operation\">\n      <span @click=\"submitUpload\">保存</span>\n      <span @click=\"close_head_portrait\">取消</span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport emitter from '@/utils/event'\nexport default {\n  name: 'HeadPortrait',\n  data () {\n    return {\n      fileList: [],\n      token: '',\n      progressFlag: false,\n      loadProgress: 0,\n      timer: null,\n      timer2: null,\n      transmission: 'success'\n    }\n  },\n  computed: {\n    config () {\n      return { Authorization: `JWT ${this.token}` }\n    }\n  },\n  methods: {\n    // 头像上传成功\n    handleAvatarSuccess (response, file, fileList) {\n      if (response.code === 200) {\n        emitter.emit('image', { aim: response.data })\n        this.timer = setInterval(() => {\n          if (this.loadProgress < 100) {\n            this.loadProgress++\n            if (this.loadProgress === 100) {\n              clearInterval(this.timer)\n              this.timer = null\n              clearInterval(this.timer2)\n              this.timer2 = null\n              this.$message({ message: '上传成功', type: 'success' })\n            }\n          }\n        }, 10)\n      } else {\n        this.transmission = 'exception'\n        this.$message.error('上传失败请稍后重试')\n      }\n    },\n    upLoad (event, file, fileList) {\n      this.progressFlag = true\n      this.timer2 = setInterval(() => {\n        this.loadProgress++\n        if (this.loadProgress > 72) {\n          clearInterval(this.timer2)\n          // 这里必须使用this.timer = null，否则清除定时器无效\n          this.timer2 = null\n        }\n      }, 100)\n    },\n    // 点击上传头像\n    submitUpload () {\n      this.token = this.$store.state.token\n      this.loadProgress = 0\n      this.$refs.upload.submit()\n    },\n    // 关闭头像选择\n    close_head_portrait () {\n      emitter.emit('show', { aim: false })\n      this.progressFlag = false\n      this.loadProgress = 0\n      this.fileList = []\n    },\n    // 上传文件的限制\n    beforeAvatarUpload (file) {\n      console.log(file.type)\n      const isJPG = file.type === 'image/png' || 'image/jpeg'\n      const isLt5M = file.size / 1024 / 1024 < 5\n\n      if (!isJPG) {\n        this.$message.error('上传头像图片只能是 JPG/PNG 格式!')\n      }\n      if (!isLt5M) {\n        this.$message.error('上传头像图片大小不能超过 5MB!')\n      }\n      return isJPG && isLt5M\n    }\n  },\n  watch: {\n    fileList: {\n      handler (newVal, oldVal) {\n        if (newVal.length > 1) {\n          newVal.splice(0, 1)\n          this.progressFlag = false\n          this.loadProgress = 0\n        }\n      },\n      deep: true\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"less\">\n#head-portrait {\n  width: 500px;\n  height: 400px;\n  z-index: 2;\n  border: 4px solid #BF809F;\n  background-color: #fff;\n  position: absolute;\n  top: 0;\n  left: 50%;\n  transform: translate(-50%, 20px);\n  .title {\n    width: 90%;\n    height: 48px;\n    border-bottom: 1px solid #ddd;\n    margin: 0 auto;\n    position: relative;\n    div {\n      border-bottom: 2px solid black;\n      width: 90px;\n      height: 48px;\n      line-height: 48px;\n      text-align: center;\n      font-size: 12px;\n    }\n    span {\n      position: absolute;\n      right: -19px;\n      top: 5px;\n      cursor: pointer;\n    }\n  }\n}\n.tips {\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  font-size: 12px;\n  height: 52px;\n  width: 444px;\n  margin: 0 auto;\n  .upImage {\n    width: 100px;\n    height: 32px;\n    border: 1px solid #C2C2C2;\n    background-color: #fafafa;\n    text-align: center;\n    line-height: 32px;\n    cursor: pointer;\n  }\n}\n#content {\n  width: 442px;\n  border: 1px solid #DDDDDD;\n  height: 237px;\n  margin: 0 auto;\n  display: flex;\n  .show {\n    width: 260px;\n    border-right: 1px solid #DDD;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n    img {\n      height: 237px;\n    }\n  }\n  .preview {\n    width: 179px;\n    display: flex;\n    flex-direction: column;\n    position: relative;\n    span {\n      margin: 30px 0 10px 30px;\n      font-size: 12px;\n      font-weight: bold;\n    }\n    div {\n      width: 108px;\n      height: 108px;\n      background-position: center;\n      background-repeat: no-repeat;\n      background-size: cover;\n      margin-left: 45px;\n      border-radius: 50%;\n    }\n    .progress {\n      position: absolute;\n      z-index: -1;\n      top: 50px;\n      left: -9px;\n      width: 125px;\n      height: 125px;\n    }\n  }\n}\n.operation {\n  width: 235px;\n  height: 50px;\n  margin: 0 auto;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  span {\n    width: 100px;\n    height: 32px;\n    text-align: center;\n    line-height: 32px;\n    border: 1px solid #C2C2C2;\n    cursor: pointer;\n    border-radius: 5px;\n    &:first-child {\n      background-color: #6C9AE1;\n      color: #fff;\n      border: 0;\n    }\n  }\n}\n:deep(.el-upload-list__item) {\n  display: none;\n}\n:deep(.el-upload--picture-card) {\n  width: 100px;\n  height: 32px;\n  margin-right: 15px;\n  border: 0;\n}\n</style>\n"]}]}